/**
 * jQuery RoughDraft.js 0.1.1 
 * Copyright Nick Dreckshage, licensed GPL & MIT
 * https://github.com/ndreckshage/roughdraft.js  
 */
;(function(e,t,n,r){e.RedPen=function(e){this._create(e);this._init()};e.RedPen.settings={author:"bacon",illustrator:"placehold",customIpsum:false,timeout:5e3,customIpsumPath:"/roughdraft.thesaurus.json",calendar:{dayNumber:"j",dayNumberZeros:"d",dayText:"l",dayTextThree:"D",monthNumber:"n",monthNumberZeros:"m",monthText:"F",monthTextThree:"M",yearNumber:"Y",yearNumberTwo:"y"},ajaxType:"GET"};e.RedPen.scopeVar={dataTag:"data-",paragraphType:"p",sentenceType:"s",wordType:"w"};e.RedPen.prototype={_create:function(t){var n=e("[data-draft-repeat]");this.options=e.extend(true,{},e.RedPen.settings,t);this.scopeVar=e.RedPen.scopeVar;e.extend(e.expr[":"],{parentsFirst:function(t,n,r){return e(t).parents(r[3]).length<1}});if(n.length){this.scanner(n)}},_init:function(){var t=e("[data-draft-text]"),n=e("[data-draft-image]"),r=e("[data-draft-date]");if(t.length){this.bookClub()}if(n.length){this.doodler(n)}if(r.length){this.scheduler(r)}},scanner:function(t){var n,r,i="draft-repeat",s,o=0;r=t.filter(":parentsFirst([data-draft-repeat])");while(r.length>0){n=e(r[0]);s=n.data(i);n.removeAttr(this.scopeVar.dataTag+i);for(var u=0;u<s;u++){n.clone(true,true).insertAfter(n)}t=e("[data-draft-repeat]");r=t.filter(":parentsFirst([data-draft-repeat])");if(o>=1e3){console.log("There was an infinite loop error. Please check the loop if you are editing it, or report the"+" error here -- https://github.com/ndreckshage/roughdraft.js/issues/new");break}o++}},bookClub:function(){var e=this.options,t=new Array,n="json",r;switch(e.author){case"lorem":r="http://www.randomtext.me/api/lorem/p-20/40-50";t=["_fixJSON","_fixParagraphs"];break;case"bacon":r="https://baconipsum.com/api/?type=all-meat&paras=20&start-with-lorem=1";n="jsonp";t=["_fixParagraphs"];break;case"hipster":r="http://hipsterjesus.com/api?paras=20&type=hipster-centric&html=false";t=["_fixJSON","_fixParagraphs"];break;default:r="https://baconipsum.com/api/?type=all-meat&paras=20&start-with-lorem=1";n="jsonp";t=["_fixParagraphs"];break}if(e.customIpsum===true){this._bookStore()}else if(r&&n&&t){this._library(r,n,t)}else{console.log("Please ensure that you have specified a correct remote (JSONP) / local"+' (thesaurus.roughdraft.json) library, and have correctly set the "customIpsum" option.')}},doodler:function(t){var n,r="draft-image",i,s,o,u;for(var a=0;a<t.length;a++){n=e(t[a]);i=n.data(r);if(typeof i==="string"){i=i.split("/");s=parseInt(i[0]);o=parseInt(i[1]);if(isNaN(s)||isNaN(o)){s=false;o=false}if(s&&o){u=this._photoAlbum(s,o);n.attr("src",u).attr("width",s).attr("height",o).removeAttr(this.scopeVar.dataTag+r)}else{console.log("Please ensure that you specify Width/Height in the format 250/300 for 250px wide by 300px tall")}}}},scheduler:function(t){var n,r="draft-date",i,s,o=new String;for(var u=0;u<t.length;u++){n=e(t[u]);i=n.data(r);if(typeof i==="string"){i=i.split("/");dateDataLength=i.length;o="";for(var a=0;a<i.length;a++){o+=this._datePicker(i[a]);a!=i.length-1?o+=" ":""}n.removeAttr(this.scopeVar.dataTag+r);n.text(o)}}},_library:function(t,n,r){var i=this,s=this.options;e.ajax({url:t,dataType:n,type:s.ajaxType,timeout:s.timeout,success:function(e){if(r.length>0){i._deweyDecimal(e,r)}else{i._speedReader(e)}},error:function(){console.log("There was an error reaching the lorem ipsum JSON API. Please confirm the link, or try"+" a different service if they are down.")}})},_bookStore:function(){var t=this.options,n=this;e.ajax({url:t.customIpsumPath,dataType:"json",async:false,type:t.ajaxType,success:function(e){if(e[t.author]){n._speedReader(e[t.author])}else{console.log("Please ensure the requested author is in your custom library and is spelled + formatted correctly.")}},error:function(){console.log("The ajax requested could not be completed. Ensure the relative path to your custom library is accurate.")}})},_deweyDecimal:function(e,t){var n=t.splice(0,1)[0];if(n=="_fixJSON"){this._fixJSON(e,t)}else if(n=="_fixParagraphs"){this._fixParagraphs(e,t)}},_fixJSON:function(e,t){var n=this.options,r=false,i;switch(n.author){case"lorem":e=e.text_out;r=true;break;case"hipster":e=e.text;default:break}e=JSON.stringify(e);e=this._replaceWith(e,"\\r","<BREAK>");e=this._replaceWith(e,"\\n","<BREAK>");if(r){e=this._replaceWith(e,"<p>","");e=this._replaceWith(e,"</p>","")}e=JSON.parse(e);e=e.split("<BREAK>");e=this._removeEmptyIndexes(e);if(t.length>0){this._deweyDecimal(e,t)}else{this._speedReader(e)}},_fixParagraphs:function(t,n){var r=this,i=new Array,s,o;for(var u=0;u<t.length;u++){o=t[u];o=this._replaceWith(o,"...","<ELLIPSES>");o=o.split(".");o=this._removeEmptyIndexes(o);s=new Array;e.each(o,function(e,t){t=r._replaceWith(t,"<ELLIPSES>","...");t=t+".";t=t.replace(/(^\s+|\s+$)/g,"");s.push(t)});i.push(s)}t=i;if(n.length>0){this._deweyDecimal(t,n)}else{this._speedReader(t)}},_speedReader:function(t){var n,r=e("[data-draft-text]"),i="draft-text",s=this.scopeVar,o,u,a;for(var f=0;f<r.length;f++){n=e(r[f]);o=n.data(i);if(typeof o==="string"){o=o.split("/");u=parseInt(o[0]);a=o[1].toLowerCase();if(isNaN(u)||typeof a!=="string"){u=false;a=false}if(u&&a){n.removeAttr(s.dataTag+i);this._inceptionLevelOne(n,t,u,a)}else{console.log("Please ensure that you specify Paragraph/Sentence/Word in the format 3/S, for 3 sentences")}}}},_inceptionLevelOne:function(e,t,n,r){var s=t.length,o=new Array,u=new Array,a=new String,f=this.scopeVar,l,c,h;if(r==f.paragraphType){while(n>0){l=this._randomizer(s);c=t[l];if(n>1){a="<br/><br/>"}else{a=""}c=c.join(" ")+a;u=u.concat(c);n--}u=u.join("");e.html(u)}else{for(i=0;i<s;i++){c=t[i];o=o.concat(c)}this._inceptionLevelTwo(e,o,n,r)}},_inceptionLevelTwo:function(e,t,n,r){var i=this.scopeVar,s=t.length,o=this._randomizer(s);if(r==i.sentenceType){var u;u=this._inceptionLevelTwoKick(n,t,o);e.text(u)}else if(r=i.wordType){var a=t[o].split(" "),f=0,l;l=this._inceptionLevelTwoKick(n,a,f);e.text(l)}},_inceptionLevelTwoKick:function(e,t,n){var r=e,i=t.length,s=new String,o=new String;while(e>0){if(e!=r){n++;if(n>=i){n=0}}s=t[n];if(e<i){s+=" "}o+=s;e--}return o},_photoAlbum:function(e,t){var n=false,r=this.options.illustrator,i="placehold",s="placekitten",o,u;switch(r){case i:break;case s:break;default:r=i;break}o=this._waterColor(r);if(r==s){u="http://placekitten.com/"+o+e+"/"+t}else{u="http://placehold.it/"+e+"x"+t+o}return u},_waterColor:function(e){var t=new Array,n="placekitten",r;if(e==n){t=[false,"g"]}else{t=["453f35","e7cead","b5ab94","eba434","64886c","b15c3a","b1956c"]}r=t.length;r=this._randomizer(r);r=t[r];if(r){if(e==n){r=r+"/"}else{r="/"+r+"/fff"}}else{r=""}return r},_datePicker:function(e){var t=this.options.calendar,n=new Date,r=false;if(e.split("-").length>1){e=e.split("-");if(e[1].toLowerCase()=="r"){r=true}e=e[0]}if(e==t.dayNumberZeros||e==t.dayTextThree||e==t.dayNumber||e==t.dayText){if(e==t.dayTextThree||e==t.dayText||e==t.dayTextThree){n=n.getDay();if(r===true){n=this._randomizer(6)}switch(n){case 0:n="Sunday";break;case 1:n="Monday";break;case 2:n="Tuesday";break;case 3:n="Wednesday";break;case 4:n="Thursday";break;case 5:n="Friday";break;case 6:n="Saturday";break;default:break}if(e==t.dayTextThree){n=n.substr(0,3)}}else{n=n.getDate();if(r===true){n=this._randomizer(28)+1}if(e==t.dayNumberZeros&&n<10){n="0"+n.toString()}}}else if(e==t.monthNumberZeros||e==t.monthTextThree||e==t.monthText||e==t.monthNumber){n=n.getMonth();if(r===true){n=this._randomizer(12)}if(e==t.monthText||e==t.monthTextThree){switch(n){case 0:n="January";break;case 1:n="February";break;case 2:n="March";break;case 3:n="April";break;case 4:n="May";break;case 5:n="June";break;case 6:n="July";break;case 7:n="August";break;case 8:n="September";break;case 9:n="October";break;case 10:n="November";break;case 11:n="December";break;default:break}if(e==t.monthTextThree){n=n.substr(0,3)}}else if(e==t.monthNumberZeros){n="0"+(n+1).toString()}else{n+=1}}else{n=n.getFullYear();if(r===true){n=this._randomizer(25);n<10?n="0"+n.toString():n=n.toString();n="20"+n}if(e==t.yearNumberTwo){n=n.toString().substr(2,3)}}return n},_randomizer:function(e){return Math.floor(Math.random()*e)},_removeEmptyIndexes:function(t){return e.grep(t,function(e){return e})},_replaceWith:function(e,t,n){var r=e.indexOf(t);while(typeof r==="number"&&r>0){e=e.replace(t,n);r=e.indexOf(t)}return e}};e.fn.roughDraft=function(t){return this.each(function(){e.data(this,"roughdraft",new e.RedPen(t,this))})}})(jQuery,window,document);